<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gyro Hitster</title>

<style>
body{
  background:#111;
  color:white;
  text-align:center;
  font-family:-apple-system, BlinkMacSystemFont, sans-serif;
  margin:0;
  padding:40px 20px;
}

h2{
  font-size:24px;
  margin-bottom:30px;
}

.bigButton{
  width:100%;
  max-width:400px;
  padding:20px;
  font-size:22px;
  font-weight:bold;
  border-radius:20px;
  border:none;
  background:#1DB954;
  color:white;
  margin:15px auto;
  display:block;
  box-shadow:0 6px 20px rgba(29,185,84,0.4);
  transition:0.15s;
}

.bigButton:active{
  transform:scale(0.96);
}

#playerContainer{
  margin-top:30px;
}

#status{
  margin-top:20px;
  font-size:18px;
  opacity:0.8;
}
</style>
</head>
<body>

<h2>ğŸµ é¦™æ¸¯ Hitster</h2>

<button class="bigButton" onclick="unlock()">
ğŸ”“ é»æˆ‘é–‹å§‹éŠæˆ²
</button>

<p id="status">è«‹å…ˆé»æ“Šé–‹å§‹</p>

<div id="playerContainer"></div>

<script>

let unlocked = false;
let showing = false;
let threshold = 150;

const trackId = "5RLv04XXxe0Nc4W7DTBJGT"; // é¢¨ç¹¼çºŒå¹

function unlock(){
  unlocked = true;
  document.getElementById("status").innerText = "è«‹ç¿»è½‰æ‰‹æ©Ÿæ’­æ”¾";
  enableGyro();
}

function enableGyro(){
  if (typeof DeviceOrientationEvent.requestPermission === 'function') {
    DeviceOrientationEvent.requestPermission()
      .then(response => {
        if (response === 'granted') {
          startGyro();
        }
      });
  } else {
    startGyro();
  }
}

function startGyro(){
  window.addEventListener("deviceorientation", function(event){

    if(!unlocked) return;

    let beta = event.beta;

    // ç¿»åˆ°èƒŒé¢ â†’ å»ºç«‹ iframe + autoplay
    if(Math.abs(beta) > threshold && !showing){
      document.getElementById("playerContainer").innerHTML =
      `<iframe
        src="https://open.spotify.com/embed/track/${trackId}?autoplay=1"
        width="100%"
        height="152"
        frameborder="0"
        allow="autoplay; encrypted-media">
      </iframe>`;

      document.getElementById("status").innerText = "â–¶ æ’­æ”¾ä¸­";
      showing = true;
    }

    // ç¿»å›ä¾† â†’ åˆªé™¤ iframeï¼ˆåœæ­¢æ’­æ”¾ï¼‰
    if(Math.abs(beta) < 30 && showing){
      document.getElementById("playerContainer").innerHTML = "";
      document.getElementById("status").innerText = "å·²åœæ­¢";
      showing = false;
    }

  });
}

</script>

</body>
</html>